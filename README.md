# snake

Консольная реализация классической игры **«Змейка»** на языке **C++**, выполненная как тестовое задание для ООО «НПО ПКРВ».  
Программа работает в стандартной консоли Windows и использует **ANSI escape-последовательности** для управления выводом, а также стандартную функцию `_kbhit()` для клавиатурного ввода.

---

## Принцип работы программы
Игрок управляет змейкой, которая перемещается по игровому полю и поедает **o**.  
Каждый съеденный объект увеличивает длину змейки и добавляет очки.  
Игра завершается при столкновении со стеной, собственным телом или нажатии кнопки `ESC`.  
Если игрок достигает заданного количества очков - он выигрывает.

---

## Управление

| Действие | Клавиши |
|--------|---------|
| Вверх    | `W` или `↑` |
| Вниз     | `S` или `↓` |
| Влево    | `A` или `←` |
| Вправо   | `D` или `→` |
| Выход    | `Esc` |

Удерживать клавиши **не требуется** — анализ идёт в реальном времени.

---

## Возможности программы

- Плавная отрисовка без мерцания (ANSI escape codes).
- Автоматическая **адаптация под текущее окно консоли**.
- При необходимости игра **сама меняет размер окна**.
- Центрирование игрового поля на экране.
- Возможность задать:
  - скорость игры (в миллисекундах);
  - ширину поля;
  - высоту поля;
  - целевой счёт (победу).
- Перезапуск без закрытия программы.
- Скрытие/показ курсора во время игры.

---

## Пример запуска
```
Размер окна консоли: 120 x 30
Нажмите Enter для использования текущих размеров.
Скорость игры (50–1000, Enter=150): 120
Введите ширину поля (10–235) или Enter: 60
Введите высоту поля (10–65) или Enter: 25
Введите цель по очкам (1–1333, Enter=10): 20
```

На экране появится поле со стенками, змейкой, едой и счетчиком очков.  
После завершения выводится результат и запрос на перезапуск. 

![Игровое поле](image/game.png)
---

## Логика игры
- Поле представляет собой двумерную область, ограниченную символом `#`.
- Положение змейки хранится в массиве точек `vector<Point>`, где первый элемент — голова.
- Каждый игровой шаг выполняет:
  1. Обработку ввода с клавиатуры (`_kbhit`, `_getch`)
  2. Перемещение головы змейки
  3. Проверку столкновений
  4. Проверку поедания еды и увеличение длины
- Игра останавливается при:
  - выходе головы за границу
  - пересечении с собственным телом
  - достижении указанного количества очков
  - нажатии клавиши `ESC`

---

## Управление консолью
Игра использует ANSI escape-последовательности:

| Операция | Код |
|---------|-----|
| Очистка экрана | `\x1b[2J` |
| Перемещение курсора | `\x1b[<row>;<col>H` |
| Скрыть/показать курсор | `\x1b[?25l` / `\x1b[?25h` |

Размеры окна определяются через PowerShell:
```
powershell -NoProfile -Command "[Console]::WindowWidth; [Console]::WindowHeight"
```

---

## Условия завершения
| Событие | Результат |
|--------|-----------|
| Столкновение со стеной | Проигрыш |
| Столкновение с телом | Проигрыш |
| Достигнут целевой счет | Победа |

---

## Системные требования

| Компонент | Требование |
|----------|------------|
| ОС       | Windows (любая, начиная с 7) |
| Компилятор | MSVC / MinGW / g++ (поддержка `<conio.h>`) |
| Консоль  | Поддержка ANSI escape codes (Windows 10+ рекомендуется) |

---

## Описание функций
| Функция | Назначение |
|--------|------------|
| `SetCursorPosition(x, y)` | Перемещает курсор по координатам. |
| `ClearScreen()` | Полностью очищает консоль и возвращает курсор в (0,0). |
| `HideCursor()` / `ShowCursor()` | Управляют отображением системного курсора. |
| `GetConsoleSize(cols, rows)` | Получает текущий размер окна через PowerShell. |
| `TryResizeConsole(cols, rows)` | Изменяет размеры окна консоли через `mode con`. |
| `GetKEY()` | Считывает нажатые клавиши без блокировки (`_kbhit()` / `_getch()`). |
| `ClearInputBuffer()` | Очищает буфер ввода, устраняя «залипшие» клавиши. |
| `RandomPoint()` | Возвращает случайную точку внутри игрового поля. |
| `IsPointOnSnake(p, snake, len)` | Проверяет, занимает ли точка часть тела змейки. |
| `DrawCell(p, ch, offsetX, offsetY)` | Рисует символ в игровом поле с учётом центрирования. |
| `DrawField(offsetX, offsetY)` | Отрисовывает рамку и пустое игровое поле. |
| `AskReplay()` | Спрашивает пользователя о повторном запуске. |

---

## Автор
**Горелов Владислав Дмитриевич**  
Октябрь 2025
